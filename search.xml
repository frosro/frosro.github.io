<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å®¹å™¨å°è®°</title>
    <url>/2020/07/04/%E5%AE%B9%E5%99%A8%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<h5 id="å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼ï¼š"><a href="#å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼ï¼š" class="headerlink" title="å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼ï¼š"></a>å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼ï¼š</h5><ol>
<li>è¿­ä»£å™¨æ¨¡å¼ï¼›[ä¾‹å­ï¼šå®¹å™¨å¾ªç¯æ‰€ä½¿ç”¨çš„ Iterator è¿­ä»£å™¨]</li>
<li>è®¾é…å™¨æ¨¡å¼ï¼šç®€å•çš„è¯´å°±æ˜¯å°†åŸæœ¬ä¸¤ä¸ªä¸ç›¸å¹²çš„ç±»è”ç³»èµ·æ¥ï¼ˆç±»ä¼¼äºå……ç”µå™¨ï¼Œè¿æ¥æ’åº§å’Œç”¨ç”µå™¨ï¼Œå°†ç”µå‹å˜æˆç”µå™¨åŒ¹é…çš„é‡çº§ï¼‰ï¼›[ä¾‹å­ï¼šArrays.asList() å°†æ•°ç»„è½¬æ¢æˆList]</li>
</ol>
<h5 id="é»˜è®¤é•¿åº¦-amp-æ‰©å®¹å¤§å°ï¼š"><a href="#é»˜è®¤é•¿åº¦-amp-æ‰©å®¹å¤§å°ï¼š" class="headerlink" title="é»˜è®¤é•¿åº¦ &amp; æ‰©å®¹å¤§å°ï¼š"></a>é»˜è®¤é•¿åº¦ &amp; æ‰©å®¹å¤§å°ï¼š</h5><ol>
<li>List</li>
</ol>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">é»˜è®¤å¤§å°</th>
<th>é»˜è®¤æ‰©å®¹</th>
<th align="center">å¤‡æ³¨</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ArrayList</td>
<td align="center">10</td>
<td>åŸæ¥çš„1.5å€</td>
<td align="center">ç”±æ•°ç»„å®ç°ï¼Œå› æ­¤æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼›æ‰©å®¹æ“ä½œéœ€è¦å°†åŸæ•°ç»„æ•´ä¸ªå¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ï¼Œä»£ä»·å¾ˆé«˜ï¼›åˆ é™¤å…ƒç´ æ˜¯å°†åˆ é™¤indexåçš„å…ƒç´ å¤åˆ¶åˆ°indexçš„ä½ç½®ï¼Œä»£ä»·å¾ˆé«˜ï¼›</td>
</tr>
<tr>
<td align="center">Vector</td>
<td align="center"></td>
<td>åŸæ¥çš„2å€</td>
<td align="center">ä¸ArrayListç›¸ä¼¼ï¼Œä½†æ˜¯ä½¿ç”¨äº†synchronizedè¿›è¡ŒåŒæ­¥ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„</td>
</tr>
</tbody></table>
<h5 id="å¾—åˆ°ä¸€ä¸ªçº¿ç¨‹-å®‰å…¨çš„ArrayListæ›¿ä»£æ–¹æ¡ˆï¼š"><a href="#å¾—åˆ°ä¸€ä¸ªçº¿ç¨‹-å®‰å…¨çš„ArrayListæ›¿ä»£æ–¹æ¡ˆï¼š" class="headerlink" title="å¾—åˆ°ä¸€ä¸ªçº¿ç¨‹ å®‰å…¨çš„ArrayListæ›¿ä»£æ–¹æ¡ˆï¼š"></a>å¾—åˆ°ä¸€ä¸ªçº¿ç¨‹ å®‰å…¨çš„ArrayListæ›¿ä»£æ–¹æ¡ˆï¼š</h5><p>  â‘    Collections.synchronizedList() </p>
<p>  â‘¡   concurrent å¹¶å‘åŒ…ä¸‹çš„ CopyOnWriteArrayList ç±»</p>
<h4 id="CopyOnWriteArrayList"><a href="#CopyOnWriteArrayList" class="headerlink" title="CopyOnWriteArrayList :"></a>CopyOnWriteArrayList :</h4><ol>
<li><p>å†™æ“ä½œåœ¨ä¸€ä¸ªå¤åˆ¶çš„æ•°ç»„ä¸Šè¿›è¡Œï¼Œè¯»æ“ä½œè¿˜æ˜¯åœ¨åŸå§‹æ•°ç»„ä¸­è¿›è¡Œï¼Œè¯»å†™åˆ†ç¦»ï¼Œäº’ä¸å½±å“ã€‚  å†™æ“ä½œéœ€è¦åŠ é”ï¼Œé˜²æ­¢å¹¶å‘å†™å…¥æ—¶å¯¼è‡´å†™å…¥æ•°æ®ä¸¢å¤±ã€‚  å†™æ“ä½œç»“æŸä¹‹åéœ€è¦æŠŠåŸå§‹æ•°ç»„æŒ‡å‘æ–°çš„å¤åˆ¶æ•°ç»„ã€‚ </p>
</li>
<li><p>é€‚ç”¨åœºæ™¯ï¼šCopyOnWriteArrayList åœ¨å†™æ“ä½œçš„åŒæ—¶å…è®¸è¯»æ“ä½œï¼Œå¤§å¤§æé«˜äº†è¯»æ“ä½œçš„æ€§èƒ½ï¼Œå› æ­¤å¾ˆé€‚åˆè¯»å¤šå†™å°‘çš„åº”ç”¨åœºæ™¯ã€‚</p>
<p>ä½†æ˜¯ CopyOnWriteArrayList æœ‰å…¶ç¼ºé™·ï¼š</p>
<ul>
<li>å†…å­˜å ç”¨ï¼šåœ¨å†™æ“ä½œæ—¶éœ€è¦å¤åˆ¶ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œä½¿å¾—å†…å­˜å ç”¨ä¸ºåŸæ¥çš„ä¸¤å€å·¦å³ï¼›</li>
<li>æ•°æ®ä¸ä¸€è‡´ï¼šè¯»æ“ä½œä¸èƒ½è¯»å–å®æ—¶æ€§çš„æ•°æ®ï¼Œå› ä¸ºéƒ¨åˆ†å†™æ“ä½œçš„æ•°æ®è¿˜æœªåŒæ­¥åˆ°è¯»æ•°ç»„ä¸­ã€‚</li>
</ul>
<p>æ‰€ä»¥ CopyOnWriteArrayList ä¸é€‚åˆå†…å­˜æ•æ„Ÿä»¥åŠå¯¹å®æ—¶æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ã€‚</p>
</li>
</ol>
<h4 id="LinkedList"><a href="#LinkedList" class="headerlink" title="LinkedList:"></a>LinkedList:</h4><p> åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œä½¿ç”¨ Node å­˜å‚¨é“¾è¡¨èŠ‚ç‚¹ä¿¡æ¯ã€‚ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é“¾è¡¨ä¸æ”¯æŒéšæœºè®¿é—®ï¼Œä½†æ’å…¥åˆ é™¤åªéœ€è¦æ”¹å˜æŒ‡é’ˆã€‚</p>
<h4 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap:"></a>HashMap:</h4><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>capacity</td>
<td>table çš„å®¹é‡å¤§å°ï¼Œé»˜è®¤ä¸º 16ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ capacity å¿…é¡»ä¿è¯ä¸º 2 çš„ n æ¬¡æ–¹ã€‚</td>
</tr>
<tr>
<td>size</td>
<td>é”®å€¼å¯¹æ•°é‡ã€‚</td>
</tr>
<tr>
<td>threshold</td>
<td>size çš„ä¸´ç•Œå€¼ï¼Œå½“ size å¤§äºç­‰äº threshold å°±å¿…é¡»è¿›è¡Œæ‰©å®¹æ“ä½œã€‚</td>
</tr>
<tr>
<td>loadFactor</td>
<td>è£…è½½å› å­ï¼Œtable èƒ½å¤Ÿä½¿ç”¨çš„æ¯”ä¾‹ï¼Œthreshold = (int)(capacity* loadFactor)ã€‚</td>
</tr>
</tbody></table>
<p><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Java%20%E5%AE%B9%E5%99%A8.md" target="_blank" rel="noopener">https://github.com/CyC2018/CS-Notes/blob/master/notes/Java%20%E5%AE%B9%E5%99%A8.md</a> (æºç åˆ†æï¼š1.7ä¸ºä¸»)</p>
<p><a href="https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/collection/HashMap.md" target="_blank" rel="noopener">https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/collection/HashMap.md</a> ï¼ˆè¯¦ç»†è®²è§£ï¼‰</p>
<p> ä» JDK 1.8 å¼€å§‹ï¼Œä¸€ä¸ªæ¡¶å­˜å‚¨çš„é“¾è¡¨é•¿åº¦å¤§äºç­‰äº 8 æ—¶ä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚ </p>
<p><strong>è¿™é‡Œéœ€è¦æ³¨æ„ï¼š1.7  putæ–¹æ³•åœ¨é“¾è¡¨ä¸­é‡‡ç”¨å¤´æ’æ³•ï¼Œå³å½“æ•°ç»„ä½ç½®ç›¸åŒï¼Œè€Œkeyä¸åŒï¼Œå°±åœ¨è¿™ä¸ªé“¾è¡¨çš„å¤´éƒ¨æ’å…¥è¯¥å…ƒç´ ï¼›1.8ä¸­åˆ™æ˜¯åœ¨é“¾è¡¨å°¾éƒ¨æ’å…¥</strong></p>
<blockquote>
<p> ä¸ºä»€ä¹ˆè¦ä»å¤´æ’æ³•æ”¹æˆå°¾æ’æ³•ï¼Ÿ </p>
<p>A.å› ä¸ºå¤´æ’æ³•ä¼šé€ æˆæ­»é“¾ï¼Œå‚è€ƒé“¾æ¥<a href="https://blog.csdn.net/chenyiminnanjing/article/details/82706942" target="_blank" rel="noopener">https://blog.csdn.net/chenyiminnanjing/article/details/82706942</a><br>B.JDK7ç”¨å¤´æ’æ˜¯è€ƒè™‘åˆ°äº†ä¸€ä¸ªæ‰€è°“çš„çƒ­ç‚¹æ•°æ®çš„ç‚¹(æ–°æ’å…¥çš„æ•°æ®å¯èƒ½ä¼šæ›´æ—©ç”¨åˆ°)ï¼Œä½†è¿™å…¶å®æ˜¯ä¸ªä¼ªå‘½é¢˜,å› ä¸ºJDK7ä¸­rehashçš„æ—¶å€™ï¼Œæ—§é“¾è¡¨è¿ç§»æ–°é“¾è¡¨çš„æ—¶å€™ï¼Œå¦‚æœåœ¨æ–°è¡¨çš„æ•°ç»„ç´¢å¼•ä½ç½®ç›¸åŒï¼Œåˆ™é“¾è¡¨å…ƒç´ ä¼šå€’ç½®(å°±æ˜¯å› ä¸ºå¤´æ’) æ‰€ä»¥æœ€åçš„ç»“æœ è¿˜æ˜¯æ‰“ä¹±äº†æ’å…¥çš„é¡ºåº æ‰€ä»¥æ€»çš„æ¥çœ‹æ”¯æ’‘JDK7ä½¿ç”¨å¤´æ’çš„è¿™ç‚¹åŸå› ä¹Ÿä¸è¶³ä»¥æ”¯æ’‘ä¸‹å»äº† æ‰€ä»¥å°±å¹²è„†æ¢æˆå°¾æ’ ä¸€ä¸¾å¤šå¾—</p>
</blockquote>
<h6 id="ä¸-Hashtable-çš„æ¯”è¾ƒ"><a href="#ä¸-Hashtable-çš„æ¯”è¾ƒ" class="headerlink" title="ä¸ Hashtable çš„æ¯”è¾ƒ"></a>ä¸ Hashtable çš„æ¯”è¾ƒ</h6><ul>
<li>Hashtable ä½¿ç”¨ synchronized æ¥è¿›è¡ŒåŒæ­¥ã€‚</li>
<li>HashMap å¯ä»¥æ’å…¥é”®ä¸º null çš„ Entryã€‚</li>
<li>HashMap çš„è¿­ä»£å™¨æ˜¯ fail-fast è¿­ä»£å™¨ã€‚</li>
<li>HashMap ä¸èƒ½ä¿è¯éšç€æ—¶é—´çš„æ¨ç§» Map ä¸­çš„å…ƒç´ æ¬¡åºæ˜¯ä¸å˜çš„ã€‚</li>
</ul>
<h4 id="ConcurrentHashMapï¼š"><a href="#ConcurrentHashMapï¼š" class="headerlink" title="ConcurrentHashMapï¼š"></a>ConcurrentHashMapï¼š</h4><h6 id="å­˜å‚¨ç»“æ„"><a href="#å­˜å‚¨ç»“æ„" class="headerlink" title="å­˜å‚¨ç»“æ„"></a>å­˜å‚¨ç»“æ„</h6><p><a href="https://mp.weixin.qq.com/s/AHWzboztt53ZfFZmsSnMSw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/AHWzboztt53ZfFZmsSnMSw</a> ï¼ˆè¯¦ç»†è®²è§£ï¼‰</p>
<p>Java7 ä¸­ ConcruuentHashMap ä½¿ç”¨çš„åˆ†æ®µé”ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ª Segment ä¸ŠåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ“ä½œï¼Œæ¯ä¸€ä¸ª Segment éƒ½æ˜¯ä¸€ä¸ªç±»ä¼¼ HashMap æ•°ç»„çš„ç»“æ„ï¼Œå®ƒå¯ä»¥æ‰©å®¹ï¼Œå®ƒçš„å†²çªä¼šè½¬åŒ–ä¸ºé“¾è¡¨ã€‚ä½†æ˜¯ Segment çš„ä¸ªæ•°ä¸€ä½†åˆå§‹åŒ–å°±ä¸èƒ½æ”¹å˜ã€‚</p>
<p> Segment ç»§æ‰¿è‡ª ReentrantLockã€‚ </p>
<p>Java8 ä¸­çš„ ConcruuentHashMap ä½¿ç”¨çš„ Synchronized é”åŠ  CAS çš„æœºåˆ¶ã€‚ç»“æ„ä¹Ÿç”± Java7 ä¸­çš„ <strong>Segment æ•°ç»„ + HashEntry æ•°ç»„ + é“¾è¡¨</strong> è¿›åŒ–æˆäº† <strong>Node æ•°ç»„ + é“¾è¡¨ / çº¢é»‘æ ‘</strong>ï¼ŒNode æ˜¯ç±»ä¼¼äºä¸€ä¸ª HashEntry çš„ç»“æ„ã€‚å®ƒçš„å†²çªå†è¾¾åˆ°ä¸€å®šå¤§å°æ—¶ä¼šè½¬åŒ–æˆçº¢é»‘æ ‘ï¼Œåœ¨å†²çªå°äºä¸€å®šæ•°é‡æ—¶åˆé€€å›é“¾è¡¨ã€‚</p>
<p>JDK8ä¹‹åï¼ŒConcurrentHashMapèˆå¼ƒäº†ReentrantLockï¼Œè€Œé‡æ–°ä½¿ç”¨äº†synchronizedã€‚å…¶åŸå› å¤§è‡´æœ‰ä¸€ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>åŠ å…¥å¤šä¸ªåˆ†æ®µé”æµªè´¹å†…å­˜ç©ºé—´ã€‚</li>
<li>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œ map åœ¨æ”¾å…¥æ—¶ç«äº‰åŒä¸€ä¸ªé”çš„æ¦‚ç‡éå¸¸å°ï¼Œåˆ†æ®µé”åè€Œä¼šé€ æˆæ›´æ–°ç­‰æ“ä½œçš„é•¿æ—¶é—´ç­‰å¾…ã€‚</li>
<li>ä¸ºäº†æé«˜ GC çš„æ•ˆç‡</li>
</ol>
<p>æ–°çš„ConcurrentHashMapä¸­ä½¿ç”¨synchronizedå…³é”®å­—+CASæ“ä½œä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼›è¯¦ç»†ä¿¡æ¯ <a href="https://my.oschina.net/pingpangkuangmo/blog/817973#h2_12" target="_blank" rel="noopener">https://my.oschina.net/pingpangkuangmo/blog/817973#h2_12</a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Segment</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">ReentrantLock</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">2249069246763182397L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_SCAN_RETRIES =</span><br><span class="line">        Runtime.getRuntime().availableProcessors() &gt; <span class="number">1</span> ? <span class="number">64</span> : <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">transient</span> <span class="keyword">volatile</span> HashEntry&lt;K,V&gt;[] table;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">transient</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">transient</span> <span class="keyword">int</span> modCount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">transient</span> <span class="keyword">int</span> threshold;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> loadFactor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> é»˜è®¤çš„å¹¶å‘çº§åˆ«ä¸º 16ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤åˆ›å»º 16 ä¸ª Segmentã€‚ </p>
<h6 id="size-æ“ä½œ"><a href="#size-æ“ä½œ" class="headerlink" title="size æ“ä½œ"></a>size æ“ä½œ</h6><p>æ¯ä¸ª Segment ç»´æŠ¤äº†ä¸€ä¸ª count å˜é‡æ¥ç»Ÿè®¡è¯¥ Segment ä¸­çš„é”®å€¼å¯¹ä¸ªæ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The number of elements. Accessed only either within locks</span></span><br><span class="line"><span class="comment"> * or among other volatile reads that maintain visibility.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> count;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œ size æ“ä½œæ—¶ï¼Œéœ€è¦éå†æ‰€æœ‰ Segment ç„¶åæŠŠ count ç´¯è®¡èµ·æ¥ã€‚</p>
<p>ConcurrentHashMap åœ¨æ‰§è¡Œ size æ“ä½œæ—¶å…ˆå°è¯•ä¸åŠ é”ï¼Œå¦‚æœè¿ç»­ä¸¤æ¬¡ä¸åŠ é”æ“ä½œå¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ã€‚</p>
<p>å°è¯•æ¬¡æ•°ä½¿ç”¨ RETRIES_BEFORE_LOCK å®šä¹‰ï¼Œè¯¥å€¼ä¸º 2ï¼Œretries åˆå§‹å€¼ä¸º -1ï¼Œå› æ­¤å°è¯•æ¬¡æ•°ä¸º 3ã€‚</p>
<p>å¦‚æœå°è¯•çš„æ¬¡æ•°è¶…è¿‡ 3 æ¬¡ï¼Œå°±éœ€è¦å¯¹æ¯ä¸ª Segment åŠ é”ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Number of unsynchronized retries in size and containsValue</span></span><br><span class="line"><span class="comment"> * methods before resorting to locking. This is used to avoid</span></span><br><span class="line"><span class="comment"> * unbounded retries if tables undergo continuous modification</span></span><br><span class="line"><span class="comment"> * which would make it impossible to obtain an accurate result.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RETRIES_BEFORE_LOCK = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Try a few times to get accurate count. On failure due to</span></span><br><span class="line">    <span class="comment">// continuous async changes in table, resort to locking.</span></span><br><span class="line">    <span class="keyword">final</span> Segment&lt;K,V&gt;[] segments = <span class="keyword">this</span>.segments;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">boolean</span> overflow; <span class="comment">// true if size overflows 32 bits</span></span><br><span class="line">    <span class="keyword">long</span> sum;         <span class="comment">// sum of modCounts</span></span><br><span class="line">    <span class="keyword">long</span> last = <span class="number">0L</span>;   <span class="comment">// previous sum</span></span><br><span class="line">    <span class="keyword">int</span> retries = -<span class="number">1</span>; <span class="comment">// first iteration isn't retry</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">            <span class="comment">// è¶…è¿‡å°è¯•æ¬¡æ•°ï¼Œåˆ™å¯¹æ¯ä¸ª Segment åŠ é”</span></span><br><span class="line">            <span class="keyword">if</span> (retries++ == RETRIES_BEFORE_LOCK) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; segments.length; ++j)</span><br><span class="line">                    ensureSegment(j).lock(); <span class="comment">// force creation</span></span><br><span class="line">            &#125;</span><br><span class="line">            sum = <span class="number">0L</span>;</span><br><span class="line">            size = <span class="number">0</span>;</span><br><span class="line">            overflow = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; segments.length; ++j) &#123;</span><br><span class="line">                Segment&lt;K,V&gt; seg = segmentAt(segments, j);</span><br><span class="line">                <span class="keyword">if</span> (seg != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    sum += seg.modCount;</span><br><span class="line">                    <span class="keyword">int</span> c = seg.count;</span><br><span class="line">                    <span class="keyword">if</span> (c &lt; <span class="number">0</span> || (size += c) &lt; <span class="number">0</span>)</span><br><span class="line">                        overflow = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¿ç»­ä¸¤æ¬¡å¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„</span></span><br><span class="line">            <span class="keyword">if</span> (sum == last)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            last = sum;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (retries &gt; RETRIES_BEFORE_LOCK) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; segments.length; ++j)</span><br><span class="line">                segmentAt(segments, j).unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> overflow ? Integer.MAX_VALUE : size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="JDK-1-8-çš„æ”¹åŠ¨"><a href="#JDK-1-8-çš„æ”¹åŠ¨" class="headerlink" title="JDK 1.8 çš„æ”¹åŠ¨"></a>JDK 1.8 çš„æ”¹åŠ¨</h6><p>JDK 1.7 ä½¿ç”¨åˆ†æ®µé”æœºåˆ¶æ¥å®ç°å¹¶å‘æ›´æ–°æ“ä½œï¼Œæ ¸å¿ƒç±»ä¸º Segmentï¼Œå®ƒç»§æ‰¿è‡ªé‡å…¥é” ReentrantLockï¼Œå¹¶å‘åº¦ä¸ Segment æ•°é‡ç›¸ç­‰ã€‚</p>
<p>JDK 1.8 ä½¿ç”¨äº† CAS æ“ä½œæ¥æ”¯æŒæ›´é«˜çš„å¹¶å‘åº¦ï¼Œåœ¨ CAS æ“ä½œå¤±è´¥æ—¶ä½¿ç”¨å†…ç½®é” synchronizedã€‚</p>
<p>å¹¶ä¸” JDK 1.8 çš„å®ç°ä¹Ÿåœ¨é“¾è¡¨è¿‡é•¿æ—¶ä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚</p>
<h4 id="LinkedHashMapï¼š"><a href="#LinkedHashMapï¼š" class="headerlink" title="LinkedHashMapï¼š"></a>LinkedHashMapï¼š</h4><p> ç»§æ‰¿è‡ª HashMapï¼Œå› æ­¤å…·æœ‰å’Œ HashMap ä¸€æ ·çš„å¿«é€ŸæŸ¥æ‰¾ç‰¹æ€§ã€‚ </p>
<p> å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œç”¨æ¥ç»´æŠ¤æ’å…¥é¡ºåºæˆ–è€… LRU é¡ºåºã€‚ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * The head (eldest) of the doubly linked list.</span><br><span class="line"> *&#x2F;</span><br><span class="line">transient LinkedHashMap.Entry&lt;K,V&gt; head;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * The tail (youngest) of the doubly linked list.</span><br><span class="line"> *&#x2F;</span><br><span class="line">transient LinkedHashMap.Entry&lt;K,V&gt; tail;</span><br></pre></td></tr></table></figure>

<p>accessOrder å†³å®šäº†é¡ºåºï¼Œé»˜è®¤ä¸º falseï¼Œæ­¤æ—¶ç»´æŠ¤çš„æ˜¯æ’å…¥é¡ºåºã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">final boolean accessOrder;</span><br></pre></td></tr></table></figure>

<p>LinkedHashMap æœ€é‡è¦çš„æ˜¯ä»¥ä¸‹ç”¨äºç»´æŠ¤é¡ºåºçš„å‡½æ•°ï¼Œå®ƒä»¬ä¼šåœ¨ putã€get ç­‰æ–¹æ³•ä¸­è°ƒç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void afterNodeAccess(Node&lt;K,V&gt; p) &#123; &#125;</span><br><span class="line">void afterNodeInsertion(boolean evict) &#123; &#125;</span><br></pre></td></tr></table></figure>

<h6 id="afterNodeAccess"><a href="#afterNodeAccess" class="headerlink" title="afterNodeAccess()"></a>afterNodeAccess()</h6><p>å½“ä¸€ä¸ªèŠ‚ç‚¹è¢«è®¿é—®æ—¶ï¼Œå¦‚æœ accessOrder ä¸º trueï¼Œåˆ™ä¼šå°†è¯¥èŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´æŒ‡å®šä¸º LRU é¡ºåºä¹‹åï¼Œåœ¨æ¯æ¬¡è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œä¼šå°†è¿™ä¸ªèŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ï¼Œä¿è¯é“¾è¡¨å°¾éƒ¨æ˜¯æœ€è¿‘è®¿é—®çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé“¾è¡¨é¦–éƒ¨å°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void afterNodeAccess(Node&lt;K,V&gt; e) &#123; &#x2F;&#x2F; move node to last</span><br><span class="line">    LinkedHashMap.Entry&lt;K,V&gt; last;</span><br><span class="line">    if (accessOrder &amp;&amp; (last &#x3D; tail) !&#x3D; e) &#123;</span><br><span class="line">        LinkedHashMap.Entry&lt;K,V&gt; p &#x3D;</span><br><span class="line">            (LinkedHashMap.Entry&lt;K,V&gt;)e, b &#x3D; p.before, a &#x3D; p.after;</span><br><span class="line">        p.after &#x3D; null;</span><br><span class="line">        if (b &#x3D;&#x3D; null)</span><br><span class="line">            head &#x3D; a;</span><br><span class="line">        else</span><br><span class="line">            b.after &#x3D; a;</span><br><span class="line">        if (a !&#x3D; null)</span><br><span class="line">            a.before &#x3D; b;</span><br><span class="line">        else</span><br><span class="line">            last &#x3D; b;</span><br><span class="line">        if (last &#x3D;&#x3D; null)</span><br><span class="line">            head &#x3D; p;</span><br><span class="line">        else &#123;</span><br><span class="line">            p.before &#x3D; last;</span><br><span class="line">            last.after &#x3D; p;</span><br><span class="line">        &#125;</span><br><span class="line">        tail &#x3D; p;</span><br><span class="line">        ++modCount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="afterNodeInsertion"><a href="#afterNodeInsertion" class="headerlink" title="afterNodeInsertion()"></a>afterNodeInsertion()</h6><p>åœ¨ put ç­‰æ“ä½œä¹‹åæ‰§è¡Œï¼Œå½“ removeEldestEntry() æ–¹æ³•è¿”å› true æ—¶ä¼šç§»é™¤æœ€æ™šçš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨é¦–éƒ¨èŠ‚ç‚¹ firstã€‚</p>
<p>evict åªæœ‰åœ¨æ„å»º Map çš„æ—¶å€™æ‰ä¸º falseï¼Œåœ¨è¿™é‡Œä¸º trueã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">afterNodeInsertion</span><span class="params">(<span class="keyword">boolean</span> evict)</span> </span>&#123; <span class="comment">// possibly remove eldest</span></span><br><span class="line">    LinkedHashMap.Entry&lt;K,V&gt; first;</span><br><span class="line">    <span class="keyword">if</span> (evict &amp;&amp; (first = head) != <span class="keyword">null</span> &amp;&amp; removeEldestEntry(first)) &#123;</span><br><span class="line">        K key = first.key;</span><br><span class="line">        removeNode(hash(key), key, <span class="keyword">null</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>removeEldestEntry() é»˜è®¤ä¸º falseï¼Œå¦‚æœéœ€è¦è®©å®ƒä¸º trueï¼Œéœ€è¦ç»§æ‰¿ LinkedHashMap å¹¶ä¸”è¦†ç›–è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼Œè¿™åœ¨å®ç° LRU çš„ç¼“å­˜ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œé€šè¿‡ç§»é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯ç¼“å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¹¶ä¸”ç¼“å­˜çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">removeEldestEntry</span><span class="params">(Map.Entry&lt;K,V&gt; eldest)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="LRU-ç¼“å­˜"><a href="#LRU-ç¼“å­˜" class="headerlink" title="LRU ç¼“å­˜"></a>LRU ç¼“å­˜</h4><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ LinkedHashMap å®ç°çš„ä¸€ä¸ª LRU ç¼“å­˜ï¼š</p>
<ul>
<li>è®¾å®šæœ€å¤§ç¼“å­˜ç©ºé—´ MAX_ENTRIES ä¸º 3ï¼›</li>
<li>ä½¿ç”¨ LinkedHashMap çš„æ„é€ å‡½æ•°å°† accessOrder è®¾ç½®ä¸º trueï¼Œå¼€å¯ LRU é¡ºåºï¼›</li>
<li>è¦†ç›– removeEldestEntry() æ–¹æ³•å®ç°ï¼Œåœ¨èŠ‚ç‚¹å¤šäº MAX_ENTRIES å°±ä¼šå°†æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ç§»é™¤ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span>&lt;<span class="title">K</span>, <span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">LinkedHashMap</span>&lt;<span class="title">K</span>, <span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ENTRIES = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">removeEldestEntry</span><span class="params">(Map.Entry eldest)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size() &gt; MAX_ENTRIES;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    LRUCache() &#123;</span><br><span class="line">        <span class="keyword">super</span>(MAX_ENTRIES, <span class="number">0.75f</span>, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    LRUCache&lt;Integer, String&gt; cache = <span class="keyword">new</span> LRUCache&lt;&gt;();</span><br><span class="line">    cache.put(<span class="number">1</span>, <span class="string">"a"</span>);</span><br><span class="line">    cache.put(<span class="number">2</span>, <span class="string">"b"</span>);</span><br><span class="line">    cache.put(<span class="number">3</span>, <span class="string">"c"</span>);</span><br><span class="line">    cache.get(<span class="number">1</span>);</span><br><span class="line">    cache.put(<span class="number">4</span>, <span class="string">"d"</span>);</span><br><span class="line">    System.out.println(cache.keySet());</span><br><span class="line">&#125;</span><br><span class="line">[<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>JAVA</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>å®¹å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºä¸äº‹åŠ¡éš”ç¦»çº§åˆ«</title>
    <url>/2020/06/04/%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA%E4%B8%8E%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/</url>
    <content><![CDATA[<h1 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h1><h4 id="äº‹åŠ¡è¯»ä¼ æ’­è¡Œä¸º"><a href="#äº‹åŠ¡è¯»ä¼ æ’­è¡Œä¸º" class="headerlink" title="äº‹åŠ¡è¯»ä¼ æ’­è¡Œä¸º"></a>äº‹åŠ¡è¯»ä¼ æ’­è¡Œä¸º</h4><h6 id="Â·-ä¿è¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­"><a href="#Â·-ä¿è¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­" class="headerlink" title="Â· ä¿è¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­"></a>Â· ä¿è¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­</h6><p>PROPAGATION_REQUIREDæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±æ–°å»ºä¸€ä¸ªï¼ˆé»˜è®¤ï¼‰<br>PROPAGATION_SUPPORTSæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¸é€‚ç”¨äº‹åŠ¡<br>PROPAGATION_MANDATORY æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸</p>
<h6 id="Â·-ä¿è¯æ²¡æœ‰åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­"><a href="#Â·-ä¿è¯æ²¡æœ‰åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­" class="headerlink" title="Â· ä¿è¯æ²¡æœ‰åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­"></a>Â· ä¿è¯æ²¡æœ‰åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­</h6><p>PROPAGATION_REQUIRES_NEWå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡<br>PROPAGATION_NOT_SUPPORTED ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡<br>PROPAGATION_NEVER ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸<br>PROPAGATION_NESTED å¦‚æœå½“å‰äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™åµŒå¥—äº‹åŠ¡æ‰§è¡Œ</p>
<h4 id="äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>äº‹åŠ¡éš”ç¦»çº§åˆ«</h4><p>DEFAULTè¿™æ˜¯ä¸€ä¸ªPlatfromTransactionManageré»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œä½¿ç”¨æ•°æ®åº“é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼›</p>
<h6 id="æœªæäº¤è¯»ï¼ˆread-uncommittedï¼‰ï¼š"><a href="#æœªæäº¤è¯»ï¼ˆread-uncommittedï¼‰ï¼š" class="headerlink" title="æœªæäº¤è¯»ï¼ˆread uncommittedï¼‰ï¼š"></a>æœªæäº¤è¯»ï¼ˆread uncommittedï¼‰ï¼š</h6><p>â€‹    äº‹åŠ¡çš„ä¿®æ”¹ï¼Œå³ä½¿å½“å‰äº‹åŠ¡æ²¡æœ‰è¢«æäº¤ï¼Œå¯¹å…¶ä»–äº‹åŠ¡è€Œè¨€ä¹Ÿæ˜¯å¯è§çš„ã€‚äº‹åŠ¡å¯ä»¥è¯»å–æœªæäº¤çš„æ•°æ®ï¼Œä¹Ÿç§°ä¸ºè„è¯»ã€‚è¿™ä¸ªçº§åˆ«ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ï¼Œæ€§èƒ½ä¸Šä¹Ÿä¸æ¯”å…¶ä»–çº§åˆ«å¥½å¤šå°‘ï¼Œä¸€èˆ¬ä¸ä¼šä½¿ç”¨ï¼›</p>
<h6 id="å·²æäº¤è¯»ï¼ˆread-committedï¼‰ï¼š"><a href="#å·²æäº¤è¯»ï¼ˆread-committedï¼‰ï¼š" class="headerlink" title="å·²æäº¤è¯»ï¼ˆread committedï¼‰ï¼š"></a>å·²æäº¤è¯»ï¼ˆread committedï¼‰ï¼š</h6><p>â€‹    å¤§éƒ¨åˆ†æ•°æ®åº“ç³»ç»Ÿçš„é»˜è®¤éš”ç¦»çº§åˆ«éƒ½æ˜¯read committedï¼ˆMysql ä¸æ˜¯ï¼‰ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªäº‹åŠ¡åªèƒ½çœ‹åˆ°å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ã€‚æ¢ä¸ªè§’åº¦æ¥è®²ï¼Œå°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æäº¤ä¹‹å‰ï¼Œæ‰€åšçš„æ“ä½œå¯¹åˆ«çš„æ“ä½œéƒ½æ˜¯ä¸å¯è§çš„ã€‚æ­¤éš”ç¦»çº§åˆ«ä¹Ÿè¢«ç§°ä¸ºï¼ˆ<strong>ä¸å¯é‡å¤è¯»</strong>ï¼‰ï¼Œå› ä¸ºå¤šæ¬¡æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢è¯­å¥ï¼Œå¯èƒ½ä¼šå¾—å‡ºä¸ä¸€æ ·çš„ç»“æœï¼Œå› ä¸ºå¯èƒ½æœ‰åˆ«çš„äº‹åŠ¡æäº¤äº†ã€‚</p>
<h6 id="å¯é‡å¤è¯»ï¼ˆrepeatable-readï¼‰ï¼š"><a href="#å¯é‡å¤è¯»ï¼ˆrepeatable-readï¼‰ï¼š" class="headerlink" title="å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰ï¼š"></a>å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰ï¼š</h6><p>â€‹    repeatable readè§£å†³äº†è„è¯»çš„é—®é¢˜ï¼Œè¯¥éš”ç¦»çº§åˆ«ä¿è¯äº†åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­æ¯æ¬¡è¯»å–éƒ½æ˜¯åŒæ ·çš„ç»“æœï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚ï¼ˆ<strong>å¹»è¯»ï¼š</strong>æŒ‡çš„æ˜¯å½“æŸä¸ªäº‹åŠ¡åœ¨è¯»å–æŸä¸ªèŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡å†è¯»å–è¯¥èŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œä¼šäº§ç”Ÿå¹»è¡Œï¼›ï¼‰ã€è¿™æ˜¯é«˜æ€§èƒ½Mysqlä¸­çš„è§£é‡Šï¼Œæˆ‘çš„ä¸ªäººç†è§£ä¸ºï¼šå…ˆè¯»å–çš„äº‹åŠ¡è¯»ä¸åˆ°åæ¥æ–°æ·»åŠ çš„è®°å½•ï¼Œå¯¼è‡´è¯»å–ä¸å‡†ç¡®ã€‘ã€‚ä½†InnoDBå’ŒXtraDBå­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰è§£å†³äº†å¹»è¯»çš„é—®é¢˜ï¼Œåé¢æˆ‘ä¼šè¯¦ç»†å†™åˆ°ã€‚</p>
<h6 id="å¯ä¸²è¡ŒåŒ–çš„ï¼ˆserializableï¼‰ï¼š"><a href="#å¯ä¸²è¡ŒåŒ–çš„ï¼ˆserializableï¼‰ï¼š" class="headerlink" title="å¯ä¸²è¡ŒåŒ–çš„ï¼ˆserializableï¼‰ï¼š"></a>å¯ä¸²è¡ŒåŒ–çš„ï¼ˆserializableï¼‰ï¼š</h6><p>å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œç”±äºå¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„è¶…æ—¶å’Œé”äº‰ç”¨ï¼Œé€šå¸¸ä¸è€ƒè™‘ã€‚<br>MySQLé»˜è®¤ï¼šå¯é‡å¤è¯»<br>Oracleé»˜è®¤ï¼šå·²æäº¤è¯»</p>
]]></content>
      <categories>
        <category>ğŸºJAVA</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>äº‹åŠ¡</tag>
      </tags>
  </entry>
  <entry>
    <title>servletå­¦ä¹ ç¬”è®°</title>
    <url>/2020/05/04/servlet%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h3 id="1-Tomcatä¸»è¦åœ¨ç¨‹åºä¸­åšäº†äº›ä»€ä¹ˆï¼Ÿ"><a href="#1-Tomcatä¸»è¦åœ¨ç¨‹åºä¸­åšäº†äº›ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.Tomcatä¸»è¦åœ¨ç¨‹åºä¸­åšäº†äº›ä»€ä¹ˆï¼Ÿ"></a>1.Tomcatä¸»è¦åœ¨ç¨‹åºä¸­åšäº†äº›ä»€ä¹ˆï¼Ÿ</h3><p>1.1  åˆ›å»ºsocketç›‘å¬åœ¨å¯¹åº”çš„ç«¯å£</p>
<p>1.2  ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± </p>
<p>1.3  å½“æœ‰TCPè¿æ¥æ—¶åˆ†é…ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†</p>
<p>1.4  ä»TCPè¿æ¥ä¸­è¯»å–æ•°æ®</p>
<p>1.5  æŒ‰ç…§HTTPåè®®è§£ææ•°æ®</p>
<p>1.6  å°†è§£æåçš„æ•°æ®åŒ…å°è£…åˆ°requestå¯¹è±¡ä¸­</p>
<p>1.7  æŒ‰ç…§web.xmlçš„æ˜ å°„å…³ç³»æ‰¾åˆ°å¯¹åº”çš„Servletç±»</p>
<p>1.8  å°†æœ€åçš„æ‰§è¡Œç»“æœresponseç»„è£…æˆHTTPåè®®æ ¼å¼çš„æ•°æ®åŒ…</p>
<p>1.9  é‡æ–°é€šè¿‡TCPè¿”å›ç»™å®¢æˆ·ç«¯</p>
<h3 id="2-è®¿é—®servlet-çš„è¿‡ç¨‹"><a href="#2-è®¿é—®servlet-çš„è¿‡ç¨‹" class="headerlink" title="2.è®¿é—®servlet çš„è¿‡ç¨‹"></a>2.è®¿é—®servlet çš„è¿‡ç¨‹</h3><p>2.1  connector è´Ÿè´£ç›‘å¬ç«¯â¼,å½“æœ‰é“¾æ¥è¿›æ¥æ—¶åˆ†é…çº¿ç¨‹å¹¶å®ä¾‹åŒ–HttpllProcessorå¯¹æ•°æ®è¿›â¾ HTTPåè®®è§£æ,ç„¶åå°†è¯·æ±‚äº¤ç»™å…¶æ‰€åœ¨çš„engineå³Catalinaæ¥å¤„ç†,å¤„ç†çš„æ˜¯åŸŸåå¯¹åº”çš„ipå’Œ ç«¯â¼8080 ,æ³¨æ„localhostä»»ç„¶æ²¡è¢«ä½¿â½¤ </p>
<p>2.2  engineå°†ä»HTTPè¯·æ±‚å¤´ä¸­è·å–hostå‚æ•°â½¤äºé€‰æ‹©â¼€ä¸ªåŒ¹é…çš„Host   å¤„ç†çš„æ˜¯ä¸»æœºå localhost(Hostå¯ä»¥é…ç½®å¤šä¸ª,å³ä½ å¯ä»¥åœ¨â¼€å°ç”µè„‘ä¸Šéƒ¨ç½²ä¸¤ä¸ªå®Œå…¨ä¸ç›¸å…³çš„webé¡¹â½¬ä¾‹å¦‚jd å’Œç™¾åº¦),æ­¤æ—¶å¤„ç†çš„æ˜¯åŸŸåå³localhost</p>
<p>2.3  Hostå°†åœ¨Contextä¸­æŸ¥æ‰¾åŒ¹é…ç¬¬â¼€çº§è·¯å¾„çš„Context(webé¡¹â½¬)   å¤„ç†çš„æ˜¯ç¬¬â¼€çº§è·¯å¾„(ServletLesson)</p>
<p>2.4  è¯»å–ServletLessoné¡¹â½¬çš„web.xmlé…ç½®,æŸ¥æ‰¾åŒ¹é…TestServletçš„Servlet</p>
<p>2.5  å®ä¾‹åŒ–Servlet,è°ƒâ½¤Serviceæ ¹æ®è¯·æ±‚ç±»å‹æ‰§â¾å¯¹åº”çš„Getæˆ–Post ,å¤„ç†çš„çœŸæ­£çš„å®¢æˆ·ç«¯è¯·æ±‚</p>
<p>2.6  Servletå“åº”â½…æ³•æ‰§â¾å®Œæ¯•å,å“åº”æ•°æ®ä¾æ¬¡è¿”å›-&gt;Context-&gt;Host-&gt;engine-&gt;connector</p>
]]></content>
      <categories>
        <category>ğŸºJAVA</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>Tomcat</tag>
        <tag>Servlet</tag>
      </tags>
  </entry>
  <entry>
    <title>éƒ¨ç½²webåˆ°Tomcatçš„ä¸‰ç§æ–¹å¼</title>
    <url>/2020/05/04/%E9%83%A8%E7%BD%B2web%E5%88%B0Tomcat%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<p>è¿™é‡Œç®€å•çš„è®°å½•tomcatçš„éƒ¨ç½²æ–¹å¼ï¼š</p>
<p>ä¸€ã€ ç›´æ¥å°† web é¡¹ç›®æ–‡ä»¶ï¼ˆä¸€èˆ¬æ˜¯å¤åˆ¶ç”Ÿæˆçš„waråŒ…ï¼‰å¤åˆ¶åˆ°tomcatçš„webappsç›®å½•ä¸­ ï¼›</p>
<p>äºŒã€åœ¨tomcatä¸­çš„confç›®å½•ä¸‹çš„server.xmlæ–‡ä»¶ä¸­ï¼Œåœ¨<Host>èŠ‚ç‚¹ä¸­æ·»åŠ ä¸€ä¸ªcontextï¼Œå…·ä½“ä¸ºï¼š</Host></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">Path</span>=<span class="string">""</span> <span class="attr">Docbase</span>=<span class="string">"ç›®æ ‡ç›®å½•ä½ç½®"</span> <span class="attr">Debug</span>=<span class="string">"0"</span> <span class="attr">Privileged</span>=<span class="string">"True"</span> <span class="attr">Reloadable</span>=<span class="string">"True"</span>&gt;</span><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„ Reloadable= â€œtrueâ€ è¿™ä¸ªå±æ€§æ˜¯æŒ‡tomcatåœ¨è¿è¡ŒçŠ¶æ€ä¸‹ä¼šè‡ªåŠ¨æ£€æµ‹åº”ç”¨ç¨‹åºçš„WEB-INF/classeså’ŒWEB-INF/libç›®å½•ä¸‹çš„classæ–‡ä»¶ï¼Œå¦‚æœç›‘æµ‹åˆ°æœ‰classæ–‡ä»¶æœ‰æ”¹åŠ¨ï¼ŒæœåŠ¡å™¨è‡ªåŠ¨åŠ è½½æ–°çš„webåº”ç”¨ç¨‹åºï¼Œå¯ä»¥åœ¨ä¸é‡èµ·tomcatçš„æƒ…å†µä¸‹æ”¹å˜åº”ç”¨ç¨‹åºï¼Œä¹Ÿå°±æ˜¯çƒ­éƒ¨ç½²ï¼›</p>
<p>ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨å¼€å‘é˜¶æ®µå°†Reloadableå±æ€§è®¾ä¸ºtrueï¼Œæœ‰åŠ©äºè°ƒè¯•servletå’Œå…¶å®ƒçš„classæ–‡ä»¶ï¼Œä½†æ˜¯ç”±äºè¿™æ ·ä¼šå¢åŠ æœåŠ¡å™¨çš„è¿è¡Œè´Ÿè·ï¼ŒæŸè€—ç³»ç»Ÿæ€§èƒ½ï¼Œåœ¨é¡¹ç›®è¿è¡Œé˜¶æ®µå»ºè®®å°†å®ƒè®¾ä¸ºfalseã€‚</p>
<p>ä¸‰ã€ç›´æ¥å°†ç¼–è¯‘åçš„é¡¹ç›®å¤åˆ¶åˆ°webappsä¸­ï¼Œç›´æ¥è®¿é—®</p>
]]></content>
      <categories>
        <category>ğŸºJAVA</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>Tomcat</tag>
      </tags>
  </entry>
  <entry>
    <title>Lambdaè¡¨è¾¾å¼å¸¸è§åº”ç”¨åœºæ™¯</title>
    <url>/2020/04/19/Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/</url>
    <content><![CDATA[<h3 id="ä¸€ã€é›†åˆä¸­çš„ä½¿ç”¨"><a href="#ä¸€ã€é›†åˆä¸­çš„ä½¿ç”¨" class="headerlink" title="ä¸€ã€é›†åˆä¸­çš„ä½¿ç”¨"></a>ä¸€ã€é›†åˆä¸­çš„ä½¿ç”¨</h3><ul>
<li><h5 id="é›†åˆçš„éå†"><a href="#é›†åˆçš„éå†" class="headerlink" title="é›†åˆçš„éå†"></a>é›†åˆçš„éå†</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–é›†åˆ</span></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">users.add(<span class="keyword">new</span> User(<span class="string">"è©¹å§†å£«"</span>,<span class="number">22</span>,<span class="string">"ç”·"</span>));</span><br><span class="line">users.add(<span class="keyword">new</span> User(<span class="string">"éœ²è¥¿"</span>,<span class="number">21</span>,<span class="string">"å¥³"</span>));</span><br><span class="line">users.add(<span class="keyword">new</span> User(<span class="string">"å¼—å…°å…‹"</span>,<span class="number">25</span>,<span class="string">"ç”·"</span>));</span><br><span class="line">users.add(<span class="keyword">new</span> User(<span class="string">"çˆ±ä¸½ä¸"</span>,<span class="number">27</span>,<span class="string">"å¥³"</span>));</span><br><span class="line">users.add(<span class="keyword">new</span> User(<span class="string">"è·¯æ˜“æ–¯"</span>,<span class="number">22</span>,<span class="string">"ç”·"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†é›†åˆ Lambda</span></span><br><span class="line">users.stream().forEach(user -&gt; System.out.println(user));</span><br><span class="line"><span class="comment">// éå†é›†åˆ æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">users.stream().forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•å¼•ç”¨ï¼ˆ::åŒå†’å·æ“ä½œç¬¦ï¼‰</strong></p>
<ol>
<li><p>å…¶å®å°±æ˜¯ä¸€ç§Lambdaè¡¨è¾¾å¼çš„ç®€å†™æ–¹å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§å¼•ç”¨è€Œä¸æ‰§è¡Œæ–¹æ³•çš„æ–¹å¼ï¼Œè¿è¡Œæ—¶ï¼Œæ–¹æ³•å¼•ç”¨ä¼šåˆ›å»ºä¸€ä¸ªå‡½æ•°å¼æ¥å£çš„å®ä¾‹ã€‚</p>
</li>
<li><p>æ–¹æ³•å¼•ç”¨çš„äº”ç§æ–¹å¼ï¼š</p>
<table>
<thead>
<tr>
<th align="center">â€”-</th>
<th align="center">â€”-</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å¼•ç”¨å¯¹è±¡çš„å®ä¾‹æ–¹æ³•</td>
<td align="center">å¯¹è±¡::å®ä¾‹æ–¹æ³•å</td>
</tr>
<tr>
<td align="center">å¼•ç”¨ç±»çš„é™æ€æ–¹æ³•</td>
<td align="center">ç±»::é™æ€æ–¹æ³•å</td>
</tr>
<tr>
<td align="center">å¼•ç”¨ç±»çš„å®ä¾‹æ–¹æ³•</td>
<td align="center">ç±»::å®ä¾‹æ–¹æ³•å</td>
</tr>
<tr>
<td align="center">å¼•ç”¨æ„é€ æ–¹æ³•</td>
<td align="center">ç±»::new</td>
</tr>
<tr>
<td align="center">æ•°ç»„å¼•ç”¨</td>
<td align="center">ç±»å‹::new</td>
</tr>
</tbody></table>
</li>
</ol>
</li>
<li><h5 id="Listè½¬Map"><a href="#Listè½¬Map" class="headerlink" title="Listè½¬Map"></a>Listè½¬Map</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œçš„toMapæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå–çš„åç§°ä¸º key,ç¬¬äºŒä¸ªå‚æ•° è¡¨ç¤ºæ•´ä¸ªuserå¯¹è±¡ä¸ºä¸€ä¸ª value,æœ€åä¸€ä¸ªå‚æ•°å¯ä»¥ä¸åŠ ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¦‚æœ key å€¼æœ‰é‡å¤çš„ï¼Œå¦‚ä½•å¤„ç†</span></span><br><span class="line">Map&lt;String, User&gt; userMap = users.stream().collect(Collectors.toMap(User::getName, a -&gt; a, (k1, k2) -&gt; k1));</span><br></pre></td></tr></table></figure>
</li>
<li><h5 id="å°†Liståˆ†ç»„"><a href="#å°†Liståˆ†ç»„" class="headerlink" title="å°†Liståˆ†ç»„"></a>å°†Liståˆ†ç»„</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®æ€§åˆ«è¿›è¡Œåˆ†ç±»</span></span><br><span class="line">Map&lt;String, List&lt;User&gt;&gt; groupBy = users.stream().collect(Collectors.groupingBy(User::getSex));</span><br></pre></td></tr></table></figure>
</li>
<li><h5 id="é›†åˆè¿‡æ»¤"><a href="#é›†åˆè¿‡æ»¤" class="headerlink" title="é›†åˆè¿‡æ»¤"></a>é›†åˆè¿‡æ»¤</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿‡æ»¤å‡ºç”·æ€§</span></span><br><span class="line">List&lt;User&gt; filterList = users.stream().filter(user -&gt; user.getSex().equals(<span class="string">"ç”·"</span>)).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>
</li>
<li><h5 id="é›†åˆæ±‚å’Œ"><a href="#é›†åˆæ±‚å’Œ" class="headerlink" title="é›†åˆæ±‚å’Œ"></a>é›†åˆæ±‚å’Œ</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¹´é¾„å’Œ</span></span><br><span class="line"><span class="keyword">int</span> sum = users.stream().mapToInt(User::getAge).sum();</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="äºŒã€ä»£æ›¿Runnable"><a href="#äºŒã€ä»£æ›¿Runnable" class="headerlink" title="äºŒã€ä»£æ›¿Runnable"></a>äºŒã€ä»£æ›¿Runnable</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ©ç”¨Lambdaå®ç°Runnableé‡Œçš„runæ–¹æ³•</span></span><br><span class="line">Runnable r = () -&gt; &#123;</span><br><span class="line">   System.out.println(Thread.currentThread().getName());</span><br><span class="line"> &#125;  ;</span><br><span class="line">Thread thread = <span class="keyword">new</span> Thread(r);</span><br><span class="line">thread.start();</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€Predicateæ¡ä»¶è¿‡æ»¤"><a href="#ä¸‰ã€Predicateæ¡ä»¶è¿‡æ»¤" class="headerlink" title="ä¸‰ã€Predicateæ¡ä»¶è¿‡æ»¤"></a>ä¸‰ã€Predicateæ¡ä»¶è¿‡æ»¤</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line">       filter(numbers,number -&gt; &#123;</span><br><span class="line">          <span class="keyword">return</span> (<span class="keyword">int</span>)number &gt; <span class="number">2</span>;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * è¿‡æ»¤æ–¹æ³•</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> list</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> condition</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">filter</span><span class="params">(List list, Predicate condition)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">       list.forEach(number -&gt; &#123;</span><br><span class="line">           <span class="keyword">if</span> (condition.test(number))&#123;</span><br><span class="line">               System.out.println(number);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="å››ã€Mapæ˜ å°„"><a href="#å››ã€Mapæ˜ å°„" class="headerlink" title="å››ã€Mapæ˜ å°„"></a>å››ã€Mapæ˜ å°„</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å°†è¿”å›ä¸€ä¸ªå°†æ¯ä¸ªæ•°å­—éƒ½Ã—2çš„æ–°List</span></span><br><span class="line">List&lt;Integer&gt; mapList = numbers.stream().map(number -&gt; number * <span class="number">2</span>).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>

<h3 id="äº”ã€Reduceèšåˆ"><a href="#äº”ã€Reduceèšåˆ" class="headerlink" title="äº”ã€Reduceèšåˆ"></a>äº”ã€Reduceèšåˆ</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿”å›æ‰€æœ‰æˆå‘˜çš„å’Œ</span></span><br><span class="line">Integer sum = numbers.stream().reduce((x, y) -&gt; x + y).get();</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ğŸºJAVA</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>Lambda</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVAåå°„æœºåˆ¶</title>
    <url>/2020/04/13/JAVA%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/</url>
    <content><![CDATA[<h1 id="JAVAåå°„æœºåˆ¶"><a href="#JAVAåå°„æœºåˆ¶" class="headerlink" title="JAVAåå°„æœºåˆ¶"></a>JAVAåå°„æœºåˆ¶</h1><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>javaåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤Ÿå¾—åˆ°è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½è°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º<strong>åå°„æœºåˆ¶</strong></p>
<h3 id="è·å–Classå¯¹è±¡çš„ä¸¤ç§æ–¹å¼"><a href="#è·å–Classå¯¹è±¡çš„ä¸¤ç§æ–¹å¼" class="headerlink" title="è·å–Classå¯¹è±¡çš„ä¸¤ç§æ–¹å¼"></a>è·å–Classå¯¹è±¡çš„ä¸¤ç§æ–¹å¼</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.å¦‚æœæˆ‘ä»¬çŸ¥é“å…·ä½“çš„ç±»,å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼Œ[ç±»å.class];ä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯ä¸çŸ¥é“å…·ä½“çš„ç±»çš„ï¼Œå¹¶ä¸”è¿˜éœ€è¦å¯¼å…¥ç±»çš„åŒ…ï¼Œä¾èµ–å¤ªå¼ºã€‚</span></span><br><span class="line">Class targetClass = TargetObject<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.é€šè¿‡[Class.forName()]å°æ‹¬å·ä¸­ä¼ å…¥ç±»çš„å­—ç¬¦ä¸²è·¯å¾„è·å–ï¼Œå­—ç¬¦ä¸²å¯ä»¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line">Class targetClass = Class.forName(<span class="string">"frosro.test.TargetObject"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.å…¶å®è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œç»§æ‰¿è‡ªObjectç±»çš„getClassæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼Œä½†è¿™æ ·å¯¹è±¡éƒ½å·²ç»å­˜åœ¨äº†ï¼Œæˆ‘ä»¬å†ç”¨åå°„å°±å¤šæ­¤ä¸€ä¸¾äº†ã€‚</span></span><br><span class="line">TargetObject targetObject = <span class="keyword">new</span> TargetObject();</span><br><span class="line">Class targetClass = targetObject.getClass();</span><br></pre></td></tr></table></figure>

<h3 id="ä»£ç æ¼”ç¤º"><a href="#ä»£ç æ¼”ç¤º" class="headerlink" title="ä»£ç æ¼”ç¤º"></a>ä»£ç æ¼”ç¤º</h3><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæˆ‘ä»¬å°†è¦æ“ä½œçš„ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> fanshe;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sy</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@data</span> 21:35</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TargetObject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TargetObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        value = <span class="string">"initVal"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">publicMethod</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I love "</span> + s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">privateMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"value is "</span> + value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨åå°„æ¥æ“ä½œè¿™ä¸ªç±»çš„æ–¹æ³•å’Œå‚æ•°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package fanshe;</span><br><span class="line"></span><br><span class="line">import java.lang.annotation.Annotation;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.lang.reflect.InvocationTargetException;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @author sy</span><br><span class="line"> * @data \ 21:36</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class Main &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException &#123;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; è·å–TargetObjectç±»çš„Classå¯¹è±¡</span><br><span class="line">        Class&lt;?&gt; tagetClass  &#x3D; Class.forName(&quot;fanshe.TargetObject&quot;);</span><br><span class="line">        &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªTargetObjectç±»çš„å®ä¾‹</span><br><span class="line">        TargetObject targetObject &#x3D; (TargetObject)tagetClass .newInstance();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; è·å–ç±»ä¸­æ‰€æœ‰å®šä¹‰çš„æ–¹æ³•</span><br><span class="line">        Method[] methods &#x3D; tagetClass.getDeclaredMethods();</span><br><span class="line">        for (Method method : methods) &#123;</span><br><span class="line">            &#x2F;&#x2F; å¾ªç¯è¾“å‡ºæ–¹æ³•åç§°</span><br><span class="line">            System.out.println(method.getName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; è·å–æŒ‡å®šæ–¹æ³•å¹¶è°ƒç”¨</span><br><span class="line">        Method publicMethod &#x3D; tagetClass.getDeclaredMethod(&quot;publicMethod&quot;, String.class);</span><br><span class="line">        publicMethod.invoke(targetObject,&quot;frosro&quot;);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; è·å–æŒ‡å®šå‚æ•°</span><br><span class="line">        Field field &#x3D; tagetClass.getDeclaredField(&quot;value&quot;);</span><br><span class="line">        &#x2F;&#x2F; å–æ¶ˆå®‰å…¨æ£€æŸ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®¿é—®åˆ°ç§æœ‰çš„å±æ€§å’Œæ–¹æ³•</span><br><span class="line">        field.setAccessible(true);</span><br><span class="line">        &#x2F;&#x2F; å¯¹å‚æ•°è¿›è¡Œä¿®æ”¹</span><br><span class="line">        field.set(targetObject,&quot;frosro&quot;);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; è°ƒç”¨ç§æœ‰çš„æ–¹æ³•</span><br><span class="line">        Method privateMethod &#x3D; tagetClass.getDeclaredMethod(&quot;privateMethod&quot;);</span><br><span class="line">        privateMethod.setAccessible(true);</span><br><span class="line">        privateMethod.invoke(targetObject);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰å…¶ä»–å¾ˆå¤šæ–¹æ³•ï¼Œå¯ä»¥ç¿»çœ‹æ–‡æ¡£æŸ¥æ‰¾ï¼›</p>
<h3 id="åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹"><a href="#åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹" class="headerlink" title="åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹"></a>åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹</h3><ul>
<li><p>ä¼˜ç‚¹ï¼š è¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦ã€‚ </p>
</li>
<li><p>ç¼ºç‚¹ï¼š  </p>
<p>1.æ€§èƒ½ç“¶é¢ˆï¼šåå°„ç›¸å½“äºä¸€ç³»åˆ—è§£é‡Šæ“ä½œï¼Œé€šçŸ¥ JVM è¦åšçš„äº‹æƒ…ï¼Œæ€§èƒ½æ¯”ç›´æ¥çš„ java ä»£ç è¦æ…¢å¾ˆå¤šã€‚</p>
<p>2.å®‰å…¨é—®é¢˜ï¼šè®©æˆ‘ä»¬å¯ä»¥åŠ¨æ€æ“ä½œæ”¹å˜ç±»çš„å±æ€§åŒæ—¶ä¹Ÿå¢åŠ äº†ç±»çš„å®‰å…¨éšæ‚£ã€‚ </p>
</li>
</ul>
<h3 id="åå°„çš„åº”ç”¨åœºæ™¯"><a href="#åå°„çš„åº”ç”¨åœºæ™¯" class="headerlink" title="åå°„çš„åº”ç”¨åœºæ™¯"></a>åå°„çš„åº”ç”¨åœºæ™¯</h3><p>åœ¨æˆ‘ä»¬å¹³æ—¶çš„é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒåŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç›´æ¥ä½¿ç”¨åˆ°åå°„æœºåˆ¶ï¼Œä½†è¿™ä¸èƒ½è¯´æ˜åå°„æœºåˆ¶æ²¡æœ‰ç”¨ï¼Œå®é™…ä¸Šæœ‰å¾ˆå¤šè®¾è®¡ã€å¼€å‘éƒ½ä¸åå°„æœºåˆ¶æœ‰å…³ï¼Œä¾‹å¦‚æ¨¡å—åŒ–çš„å¼€å‘ï¼Œé€šè¿‡åå°„å»è°ƒç”¨å¯¹åº”çš„å­—èŠ‚ç ï¼›åŠ¨æ€ä»£ç†è®¾è®¡æ¨¡å¼ä¹Ÿé‡‡ç”¨äº†åå°„æœºåˆ¶ï¼Œè¿˜æœ‰æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„ Springï¼Hibernate ç­‰æ¡†æ¶ä¹Ÿå¤§é‡ä½¿ç”¨åˆ°äº†åå°„æœºåˆ¶ã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<ol>
<li>æˆ‘ä»¬åœ¨ä½¿ç”¨ JDBC è¿æ¥æ•°æ®åº“æ—¶ä½¿ç”¨ <code>Class.forName()</code>é€šè¿‡åå°„åŠ è½½æ•°æ®åº“çš„é©±åŠ¨ç¨‹åºï¼›</li>
<li>Spring æ¡†æ¶çš„ IOCï¼ˆåŠ¨æ€åŠ è½½ç®¡ç† Beanï¼‰åˆ›å»ºå¯¹è±¡ä»¥åŠ AOPï¼ˆåŠ¨æ€ä»£ç†ï¼‰åŠŸèƒ½éƒ½å’Œåå°„æœ‰è”ç³»ï¼›</li>
<li>åŠ¨æ€é…ç½®å®ä¾‹çš„å±æ€§ï¼›</li>
</ol>
]]></content>
      <categories>
        <category>ğŸºJAVA</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>åå°„</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVAé›†åˆçš„å¤šç§éå†æ–¹å¼æ€»ç»“</title>
    <url>/2020/03/29/JAVA%E9%9B%86%E5%90%88%E7%9A%84%E5%A4%9A%E7%A7%8D%E9%81%8D%E5%8E%86%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<ol>
<li>Collection é›†åˆ :  æ€»çš„æ¥è¯´åˆ†ä¸ºä»¥ä¸‹è¿™ä¸‰ç±»ï¼Œè¿™é‡Œæ›´å¤šçš„å­ç±»æˆ‘ä¾¿ä¸åœ¨é˜è¿°äº†ã€‚</li>
</ol>
<ul>
<li>Set ï¼š æ— åºé›†åˆï¼Œå…ƒç´ ä¸å¯é‡å¤ï¼›</li>
<li>Queue  ï¼š é˜Ÿåˆ—ï¼›</li>
<li>List ï¼š æœ‰åºé›†åˆï¼Œå…ƒç´ å¯ä»¥é‡å¤ï¼›</li>
</ul>
<ol start="2">
<li>Mapé›†åˆ ï¼šä¸€èˆ¬ç”¨äºä¿å­˜æ‹¥æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ key-value é”®å€¼å¯¹ï¼Œå®ƒä¹Ÿæœ‰å¾ˆå¤šå­ç±»ï¼Œè¿™é‡Œä¸ç»†è¯´ï¼›</li>
</ol>
<hr>
<p>æœ¬æ–‡ä»¥HashSet ä¸ºä¾‹ï¼Œæ€»ç»“éå†æ–¹å¼ã€‚å½“ç„¶åƒListè¿™ç§æœ‰åºé›†åˆè¿˜å¯ä»¥é€šè¿‡forå¾ªç¯çš„æ–¹å¼éå†ã€‚</p>
<p><strong>ä¸‹é¢æ˜¯ä¸»è¦å†…å®¹ï¼š</strong></p>
<h3 id="ä¸€ã€ä½¿ç”¨-Lambda-è¡¨è¾¾å¼éå†é›†åˆ"><a href="#ä¸€ã€ä½¿ç”¨-Lambda-è¡¨è¾¾å¼éå†é›†åˆ" class="headerlink" title="ä¸€ã€ä½¿ç”¨ Lambda è¡¨è¾¾å¼éå†é›†åˆ"></a>ä¸€ã€ä½¿ç”¨ Lambda è¡¨è¾¾å¼éå†é›†åˆ</h3><p>ä» JDK8 å¼€å§‹ï¼ŒIterable æ¥å£æ–°å¢äº† forEach(Consumer action)æ–¹æ³•ï¼Œä¸»è¦ æ˜¯ä½¿ç”¨ Lambda è¡¨è¾¾å¼æ›´åŠ ç®€æ´çš„æ“ä½œã€‚Consumer å…¶å®æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥ å£ï¼Œåªè¦æ˜¯å‡½æ•°å¼æ¥å£ï¼Œéƒ½èƒ½å¤Ÿä½¿ç”¨ Lambda è¡¨ç¤ºæ¥è¿›è¡Œæ›¿ä»£ã€‚åœ¨è°ƒç”¨è¿™ ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå…¶å®ä¼šä¾æ¬¡å°†é›†åˆçš„å…ƒç´ ä¼ é€’ç»™ Consumer ä¸­çš„ accept(T t) æ–¹æ³•å»å¤„ç†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @author frosro</span><br><span class="line"> * @data 21:34</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class CollectionEach &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        HashSet&lt;String&gt; books &#x3D; new HashSet&lt;&gt;();</span><br><span class="line">        books.add(&quot;ç¼–ç¨‹æ€æƒ³&quot;);</span><br><span class="line">        books.add(&quot;æ ¸å¿ƒæŠ€æœ¯&quot;);</span><br><span class="line">        books.add(&quot;ä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;);</span><br><span class="line">        books.forEach(str -&gt; System.out.println(&quot;ä¹¦åï¼š&quot;  + str));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒã€-ä½¿ç”¨-Iterator-éå†é›†åˆå…ƒç´ "><a href="#äºŒã€-ä½¿ç”¨-Iterator-éå†é›†åˆå…ƒç´ " class="headerlink" title="äºŒã€ ä½¿ç”¨ Iterator éå†é›†åˆå…ƒç´ "></a>äºŒã€ ä½¿ç”¨ Iterator éå†é›†åˆå…ƒç´ </h3><p>Iterator ä¸»è¦ç”¨æ¥éå† Conllection é›†åˆä¸­çš„å…ƒç´ ï¼Œä¹Ÿå«è¿­ä»£å™¨ã€‚å®ƒåªèƒ½ç”¨äºéå†é›†åˆã€‚</p>
<p>å¸¸ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>hasNext()ï¼šåˆ¤æ–­é›†åˆä¸­è¿˜æœ‰æ²¡æœ‰å…ƒç´ ï¼Œå¦‚æœæœ‰åˆ™è¿”å› trueã€‚ </li>
<li>next()ï¼šå–å‡ºé›†åˆä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ </li>
<li>remove()ï¼šç§»é™¤ä¸Šé¢ next() æ–¹æ³•ä¸­è¯»å–çš„å…ƒç´ ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @author frosro</span><br><span class="line"> * @data 21:48</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class IteratorTest &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        HashSet&lt;String&gt; books &#x3D; new HashSet&lt;&gt;();</span><br><span class="line">        books.add(&quot;ç¼–ç¨‹æ€æƒ³&quot;);</span><br><span class="line">        books.add(&quot;æ ¸å¿ƒæŠ€æœ¯&quot;);</span><br><span class="line">        books.add(&quot;ä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; é€šè¿‡ iterator() æ–¹æ³•ï¼Œè·å– books é›†åˆå¯¹åº”çš„è¿­ ä»£å™¨</span><br><span class="line">        Iterator&lt;String&gt; iterator &#x3D; books.iterator();</span><br><span class="line"></span><br><span class="line">        while (iterator.hasNext())&#123;</span><br><span class="line">            String next &#x3D; iterator.next();</span><br><span class="line">            System.out.println(next);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; å¯¹ next å˜é‡èµ‹å€¼ï¼Œä¸ä¼šæ”¹å˜é›†åˆå…ƒç´ æœ¬èº«</span><br><span class="line">            &#x2F;&#x2F; Iterator å¹¶ä¸ä¼šæŠŠé›†åˆå…ƒç´ æœ¬èº«äº¤ç»™è¿­ä»£å˜ é‡ï¼Œ</span><br><span class="line">            &#x2F;&#x2F; è€Œæ˜¯æŠŠé›†åˆå…ƒç´ çš„å€¼äº¤ç»™äº†è¿­ä»£å˜é‡</span><br><span class="line">            &#x2F;&#x2F; æ‰€ä»¥åœ¨ä¿®æ”¹è¿­ä»£å˜é‡çš„å€¼ä¹‹åå¯¹é›†åˆè¿œå¤ä¸‰æœ¬èº«å¹¶ æ²¡æœ‰ä»»ä½•è¦†ç›–ã€‚</span><br><span class="line">            next &#x3D; &quot;è®¾è®¡æ¨¡å¼&quot;;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; å¦‚æœæˆ‘ä»¬åœ¨ä½¿ç”¨è¿­ä»£å™¨çš„è¿‡ç¨‹ä¸­æ”¹å˜äº†é›†åˆå…ƒç´ çš„å€¼ï¼Œä¹Ÿå°±æ˜¯books,æ¯”å¦‚</span><br><span class="line">            &#x2F;&#x2F; books.remove(next);</span><br><span class="line">            &#x2F;&#x2F; ä¸Šé¢è¿™è¡Œä»£ç è¿è¡Œä¼šæŠ¥ ConcurrentModificationException å¼‚å¸¸</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(books);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ¬è´¨ä¸Šï¼Œæ˜¯å› ä¸º Iterator è¿­ä»£å™¨ä½¿ç”¨äº† fail-fast æœºåˆ¶ï¼ˆå¿«é€Ÿå¤±è´¥æœºåˆ¶ï¼‰ï¼Œ åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¸€æ—¦å‘ç°æœ‰å…¶ä»–çº¿ç¨‹æ¥ä¿®æ”¹è¯¥é›†åˆï¼Œåˆ™é©¬ä¸ŠæŠ¥ ConcurrentModicationException å¼‚å¸¸ï¼Œè¿™æ ·åšå¯ä»¥é¿å…å…±äº«èµ„æºè€ŒåŸ‹ä¸‹å…¶ä»–éšæ‚£é—®é¢˜ã€‚</p>
<h3 id="ä¸‰ã€-ä½¿ç”¨-Lambda-è¡¨è¾¾å¼éå†-Iterator"><a href="#ä¸‰ã€-ä½¿ç”¨-Lambda-è¡¨è¾¾å¼éå†-Iterator" class="headerlink" title="ä¸‰ã€ ä½¿ç”¨ Lambda è¡¨è¾¾å¼éå† Iterator"></a>ä¸‰ã€ ä½¿ç”¨ Lambda è¡¨è¾¾å¼éå† Iterator</h3><p>æ ¸å¿ƒæ–¹æ³•ï¼š</p>
<ul>
<li>forEachRemaining()ï¼šJDK8 æ–°å¢æ–¹æ³•ï¼Œä½¿ç”¨ Lambda è¡¨è¾¾å¼æ¥éå†é›†åˆå…ƒç´ ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @author frosro</span><br><span class="line"> * @data 22:06</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class IteratorEach &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        HashSet&lt;String&gt; books &#x3D; new HashSet&lt;&gt;();</span><br><span class="line">        books.add(&quot;ç¼–ç¨‹æ€æƒ³&quot;);</span><br><span class="line">        books.add(&quot;æ ¸å¿ƒæŠ€æœ¯&quot;);</span><br><span class="line">        books.add(&quot;ä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;);</span><br><span class="line"></span><br><span class="line">        Iterator&lt;String&gt; iterator &#x3D; books.iterator();</span><br><span class="line"></span><br><span class="line">        iterator.forEachRemaining(str -&gt; System.out.println(&quot;è¿­ä»£é›†åˆå…ƒç´ ï¼š&quot; + str));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å››ã€-ä½¿ç”¨-foreach-å¾ªç¯éå†é›†åˆå…ƒç´ "><a href="#å››ã€-ä½¿ç”¨-foreach-å¾ªç¯éå†é›†åˆå…ƒç´ " class="headerlink" title="å››ã€  ä½¿ç”¨ foreach å¾ªç¯éå†é›†åˆå…ƒç´ "></a>å››ã€  ä½¿ç”¨ foreach å¾ªç¯éå†é›†åˆå…ƒç´ </h3><p>foreach å¾ªç¯ï¼Œæ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸€ç§éå†æ–¹å¼ã€‚å¦å¤–ï¼Œforeach å¾ªç¯ä¸­è¿­ä»£å˜é‡ä¹Ÿä¸æ˜¯é›†åˆå…ƒç´ æœ¬èº«ï¼Œå…¶å®ä¹Ÿæ˜¯æŠŠæ¯ä¸ªé›†åˆå…ƒç´ çš„å€¼èµ‹ç»™äº†è¿­ä»£å˜é‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @author frosro</span><br><span class="line"> * @data 22:13</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class ForeachTest &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        HashSet&lt;String&gt; books &#x3D; new HashSet&lt;&gt;();</span><br><span class="line">        books.add(&quot;ç¼–ç¨‹æ€æƒ³&quot;);</span><br><span class="line">        books.add(&quot;æ ¸å¿ƒæŠ€æœ¯&quot;);</span><br><span class="line">        books.add(&quot;ä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;);</span><br><span class="line"></span><br><span class="line">        for (String book : books) &#123;</span><br><span class="line">            System.out.println(book);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; æ”¹å˜bookçš„å€¼ï¼Œå¹¶ä¸ä¼šæ”¹å˜booksé›†åˆçš„æ•°æ®</span><br><span class="line">            &#x2F;&#x2F; å› ä¸ºbookåªæ˜¯ä¿å­˜ç€bookså…¶ä¸­çš„ä¸€ä¸ªå€¼</span><br><span class="line">            book &#x3D; &quot;è®¾è®¡æ¨¡å¼&quot;;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½åœ¨éå†æ—¶æ”¹å˜åŸæœ‰çš„é›†åˆbooks</span><br><span class="line">            &#x2F;&#x2F; å¦‚æœåƒä¸‹é¢è¿™ç§æ–¹å¼ï¼Œä¼šæŠ¥ ConcurrentModificationException</span><br><span class="line">            &#x2F;&#x2F; books.remove(book);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(books);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="äº”ã€-ä½¿ç”¨-Streaméå†é›†åˆ"><a href="#äº”ã€-ä½¿ç”¨-Streaméå†é›†åˆ" class="headerlink" title="äº”ã€  ä½¿ç”¨ Streaméå†é›†åˆ"></a>äº”ã€  ä½¿ç”¨ Streaméå†é›†åˆ</h3><p>JDK8 æ–°å¢äº† Streamã€IntStreamã€LongStreamã€DoubleStream ç­‰å¼ºæ‚çš„ æµå¼ APIï¼Œä»£è¡¨å¤šä¸ªæ”¯æŒä¸²è¡Œ &amp; å¹¶è¡Œèšé›†æ“ä½œçš„å…ƒç´ ã€‚è¿˜å¯ä»¥é€šè¿‡ç‰¹åˆ«æ ä¾›çš„ Builder æ¥åˆ›å»ºå¯¹åº”çš„æµã€‚</p>
<p>ä½¿ç”¨æ­¥éª¤ï¼š</p>
<p> 1ï¼‰ä½¿ç”¨ Stream æˆ– XxxStream çš„ builder() æ–¹æ³•åˆå§‹åŒ–å¯¹åº” çš„ Builderã€‚<br>2ï¼‰å¤šæ¬¡è°ƒç”¨ Builder çš„ add() æ–¹æ³•ï¼Œæ·»åŠ å…ƒç´ <br>3ï¼‰è°ƒç”¨ Builder çš„ build() æ–¹æ³•è·å–å¯¹åº”çš„ Streamã€‚<br>4ï¼‰è°ƒç”¨ Stream çš„èšé›†æ–¹æ³•ã€‚ï¼ˆå…·ä½“å‚è€ƒ API æ–‡æ¡£ï¼‰</p>
<p>Stream æä¾›äº†å¾ˆå¤šæ–¹æ³•ï¼Œå¯ä»¥å½’ç±»ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>Intermediateï¼ˆä¸­é—´æ–¹æ³•ï¼‰<br>ä¸­é—´æ–¹æ³•ï¼ŒæŒ‡çš„æ˜¯ä¸­é—´æ“ä½œå…è®¸æµä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå¹¶å…è®¸ç›´æ¥è°ƒç”¨åç»­æ–¹ æ³•ï¼Œä¸­é—´æ–¹æ³•çš„è¿”å›å€¼æ˜¯å¦å¤–ä¸€ä¸ªæµã€‚</li>
<li>Terminalï¼ˆæœ«ç«¯æ–¹æ³•ï¼‰<br>æœ«ç«¯æ–¹æ³•ï¼ŒæŒ‡çš„æ˜¯å¯¹æµçš„ç»ˆæ“ä½œï¼Œæ‰§è¡Œè¿‡åï¼Œè¯¥æµå°±ä¼šè¢«â€œæ¶ˆè€—â€ä¸”ä¸å†å¯ç”¨ã€‚å› ä¸ºæˆ‘ä»¬åœ¨æ“ä½œçš„æ—¶å€™ï¼Œæ˜¯åœ¨å†…å­˜ä¸­çš„ç¼“å­˜ä¸­ï¼Œå¦‚æœæ“ä½œå®Œæ¯•ï¼Œå®ƒå°†ä¼šä»ç¼“å†²ä¸­åˆ·æ–°flush() å‡ºæ¥ï¼Œå°±ä¸èƒ½å†æ”¹äº†ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @author frosro</span><br><span class="line"> * @data 22:29</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class IntStreamTest &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">       Stream stream &#x3D; Stream.builder()</span><br><span class="line">               .add(&quot;ç¼–ç¨‹æ€æƒ³&quot;)</span><br><span class="line">                .add(&quot;æ ¸å¿ƒæŠ€æœ¯&quot;)</span><br><span class="line">                .add(&quot;ä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;).build();</span><br><span class="line"></span><br><span class="line">       &#x2F;&#x2F; å½“ç„¶ï¼Œè¿™é‡Œä¸å¯é¿å…çš„ç”¨åˆ°äº†forEach</span><br><span class="line">       stream.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…æ˜¯è¿™æ ·</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @author frosro</span><br><span class="line"> * @data 22:29</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class IntStreamTest &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        HashSet&lt;String&gt; books &#x3D; new HashSet&lt;&gt;();</span><br><span class="line">        books.add(&quot;ç¼–ç¨‹æ€æƒ³&quot;);</span><br><span class="line">        books.add(&quot;æ ¸å¿ƒæŠ€æœ¯&quot;);</span><br><span class="line">        books.add(&quot;ä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;);</span><br><span class="line"></span><br><span class="line">        books.stream().forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯èƒ½ä½ ä¼šè§‰å¾—è¿™å’Œç¬¬ä¸€ç§æ–¹å¼å¾ˆåƒï¼Œæˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œè¿™ä¸¤è€…æ•ˆç‡ä¹Ÿç›¸å·®æ— å‡ ã€‚<br>ä½†æ˜¯streamæµå´æ˜¯ç›®å‰å¿…é¡»æŒæ¡çš„æ–¹å¼ã€‚å› ä¸ºå®ƒçš„ä¸€äº›å…¶ä»–ç”¨æ³•éƒ½é¢‡ä¸ºé‡è¦ã€‚</p>
]]></content>
      <categories>
        <category>ğŸºJAVA</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>å¾ªç¯</tag>
        <tag>é›†åˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>æˆ‘çš„ç¬¬ä¸€ç¯‡åšæ–‡</title>
    <url>/2020/03/28/myfirstPage/</url>
    <content><![CDATA[<p>æˆ‘çš„ä¸ªäººåšå®¢ç®—æ˜¯å»ºç«‹äº†ï¼Œä¸­é—´é‡åˆ°æ¯”è¾ƒå‘çš„å°±æ˜¯ï¼Œæˆ‘æƒ³è¦ä½¿ç”¨javaåšåˆ†ç±»ï¼Œä½†æ€»æ˜¯æŠ¥404ï¼Œä½†æ˜¯JAVAå´å¯ä»¥ï¼Œæ²¡æ‰¾åˆ°åŸå› ï¼›è¿˜æœ‰å°±æ˜¯é˜¿é‡Œäº‘çš„åŸŸåçœŸçš„æ˜¯å‘ï¼Œæäº¤äº†åå‡ ä¸ªå®åè®¤è¯è¿˜æ˜¯æ²¡é€šè¿‡ï¼Œå¤ªè€ƒéªŒè€å¿ƒäº†ã€‚markdownè¿˜ä¸å¤ªä¼šç”¨ï¼Œæ¸æ¸ç†Ÿç»ƒå§ï¼Œä¹‹åæˆ‘ä¼šæŠŠé‡åˆ°çš„å¥½çš„ç»éªŒåˆ†äº«åˆ°è¿™ä¸ªåšå®¢ï¼Œå…¶ä»–æ•™ç¨‹ä»€ä¹ˆçš„ç½‘ä¸Šå¤ªå¤šäº†ï¼Œæˆ‘å°±ä¸åœ¨è¿™ä¸Šé¢æ·»åŠ äº†ï¼Œæˆ‘åªå†™æˆ‘è®¤ä¸ºæœ‰ä»·å€¼çš„åšæ–‡ï¼Œå¦‚æœå“ªä½åŒå­¦æœ‰é—®é¢˜æˆ–è€…æƒ³è¦å’Œæˆ‘åœ¨æŠ€æœ¯ä¸Šäº¤æµï¼Œå¯ä»¥è”ç³»æˆ‘ï¼Œæˆ‘ä¼šéå¸¸ä¹æ„åˆ†äº«æˆ‘æ‰€çŸ¥é“çš„ä¿¡æ¯ã€‚å¤§å®¶ä¸€èµ·å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ä¸ºç¤¾ä¼šä¸»ä¹‰åšè´¡çŒ®ï¼</p>
]]></content>
      <categories>
        <category>ğŸŸå°å°è®°</category>
      </categories>
      <tags>
        <tag>å†å²</tag>
      </tags>
  </entry>
</search>
